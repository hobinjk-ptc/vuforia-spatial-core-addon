<!DOCTYPE html>
<html lang="en">
<head>
    <script src="objectDefaultFiles/object.js"></script>
    <script src="objectDefaultFiles/pep.min.js"></script>
    <script src="objectDefaultFiles/envelopeContents.js"></script>
    <meta charset="UTF-8">
    <title>switch</title>
    <style>
        #off {
            position: absolute;
            left: 0;
            top: 0;
            width: 570px;
            height: 310px;
        }
        #on {
            position: absolute;
            left: 0;
            top: 0;
            width: 570px;
            height: 310px;
        }
    </style>
</head>
<body style="width: 570px; height: 310px;">
<svg id="off" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 166.67 90">
    <defs>
        <style>
            .cls-1 {
                opacity: 0.25;
            }

            .cls-2 {
                fill: #00fb00;
            }

            .cls-3 {
                fill: #ff007d;
            }
            
            .background {
                fill: black;
            }
        </style>
    </defs>
    <title>Asset 35</title>
    <g id="Layer_2" data-name="Layer 2">
        <g id="offUI">
            <g>
                <g class="cls-1">
                    <polygon class="background" points="162 75.33 162 14.67 135 14.67 101.33 14.67 101.33 43.34 101.33 75.33 162 75.33"/>
                </g>
                <path class="cls-2" d="M162,14.67V75.33H101.33V14.67H162M165.33,10H98a1.33,1.33,0,0,0-1.33,1.33V78.67A1.33,1.33,0,0,0,98,80h67.33a1.34,1.34,0,0,0,1.34-1.33V11.33A1.34,1.34,0,0,0,165.33,10Z"/>
                <g class="cls-1">
                    <path class="cls-2" d="M157.33,19.33V70.67H106V19.33h51.33M162,14.67H101.33V75.33H162V14.67Z"/>
                </g>
                <g class="cls-1">
                    <polygon class="background" points="85.33 85.33 85.33 4.67 48.34 4.67 4.67 4.67 4.67 43.34 4.67 85.33 85.33 85.33"/>
                </g>
                <path class="cls-3" d="M85.33,4.67V85.33H4.67V4.67H85.33M88.67,0H1.33A1.34,1.34,0,0,0,0,1.33V88.67A1.34,1.34,0,0,0,1.33,90H88.67A1.34,1.34,0,0,0,90,88.67V1.33A1.34,1.34,0,0,0,88.67,0Z"/>
                <g class="cls-1">
                    <path class="cls-3" d="M80.67,9.33V80.67H9.33V9.33H80.67m4.66-4.66H4.67V85.33H85.33V4.67Z"/>
                </g>
                <rect class="cls-2" x="128.75" y="27.5" width="5.83" height="35" transform="translate(263.33 90) rotate(180)"/>
                <path class="cls-3" d="M45,30A15,15,0,1,1,30,45,15,15,0,0,1,45,30m0-7.5A22.5,22.5,0,1,0,67.5,45,22.52,22.52,0,0,0,45,22.5Z"/>
            </g>
        </g>
    </g>
</svg>

<svg id="on" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 167.51 90">
    <title>Asset 37</title>
    <g id="Layer_2" data-name="Layer 2">
        <g id="onUI">
            <g>
                <g>
                    <g class="cls-1">
                        <polygon class="background" points="162.85 85.33 162.85 4.67 115.85 4.67 82.18 4.67 82.18 43.34 82.18 85.33 162.85 85.33"/>
                    </g>
                    <path class="cls-2" d="M162.85,4.67V85.33H82.18V4.67h80.67M166.18,0H78.85a1.34,1.34,0,0,0-1.34,1.33V88.67A1.34,1.34,0,0,0,78.85,90h87.33a1.33,1.33,0,0,0,1.33-1.33V1.33A1.33,1.33,0,0,0,166.18,0Z"/>
                    <g class="cls-1">
                        <path class="cls-2" d="M158.18,9.33V80.67H86.85V9.33h71.33m4.67-4.66H82.18V85.33h80.67V4.67Z"/>
                    </g>
                    <rect class="cls-2" x="118.76" y="22.5" width="7.5" height="45" transform="translate(245.02 90) rotate(180)"/>
                </g>
                <g>
                    <g class="cls-1">
                        <polygon class="cls-3" points="65.92 75.92 65.92 14.08 33.55 14.08 4.08 14.08 4.08 43.55 4.08 75.92 65.92 75.92"/>
                    </g>
                    <path class="cls-3" d="M65.92,14.08V75.92H4.08V14.08H65.92M68.83,10H1.17A1.17,1.17,0,0,0,0,11.17V78.83A1.17,1.17,0,0,0,1.17,80H68.83A1.17,1.17,0,0,0,70,78.83V11.17A1.17,1.17,0,0,0,68.83,10Z"/>
                    <g class="cls-1">
                        <path class="cls-3" d="M61.83,18.17V71.83H8.17V18.17H61.83m4.09-4.09H4.08V75.92H65.92V14.08Z"/>
                    </g>
                    <path class="cls-3" d="M35,34.79A10.21,10.21,0,1,1,24.79,45,10.22,10.22,0,0,1,35,34.79m0-5.1A15.31,15.31,0,1,0,50.31,45,15.33,15.33,0,0,0,35,29.69Z"/>
                </g>
            </g>
        </g>
    </g>
</svg>



<script>
    var isOn = false;
    document.querySelector('#on').style.visibility = 'hidden';
    // TODO: load correct state

    var properties = {
        value: 0,
        unitMax: 0,
        unitMin: 0,
        unit: ""
    };

    function execute(number) {
        console.log('write ' + number);
        properties.value = number;
        try {
            realityInterface.write('value', number);
        } catch (e) {
            console.warn('Reality Interface is not accessible');
        }
    }
    
    document.addEventListener('pointerdown', function(e) {
        if (isOn) {
            if (e.pageX < 280) {
                updateState(false);
            }
        } else {
            if (e.pageX > 310) {
                updateState(true);
            }
        }
    });
    
    function updateState(newIsOn, ignoreWrite) {
        isOn = newIsOn;
        if (newIsOn) {
            document.querySelector('#on').style.visibility = '';
            document.querySelector('#off').style.visibility = 'hidden';
        } else {
            document.querySelector('#off').style.visibility = '';
            document.querySelector('#on').style.visibility = 'hidden';
        }
        
        if (!ignoreWrite) {
            execute(newIsOn ? 1 : 0);
        }
    }

    try {
        var realityInterface = new RealityInterface();
        realityInterface.initNode('value', 'node', 0, 0);

        var _envelopeContents = new EnvelopeContents(realityInterface, document.body);
        realityInterface.setMoveDelay(1000);

        realityInterface.addReadListener('value', function (e) {
            properties.value = e.value;
            updateState(properties.value >= 0.5, 'ignore');
        });
    } catch (e) {
        console.warn('Reality Interface is not accessible');
    }
</script>

</body>
</html>
