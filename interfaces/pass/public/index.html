<html>
<link rel="stylesheet" type="text/css" href="/slick/slick.css"/>

<link rel="stylesheet" type="text/css" href="/slick/slick-theme.css"/>


<body>



<!-- <div id="gif_holder"> -->
<div class="gif_holder_class" id="gif_holder" style="width: 80vw; position: absolute; left: 10vw; top: 10vh">
</div>
<style>
.slick-prev:before, .slick-next:before { 
    color:purple !important;
}
</style>
<!-- </div> -->



<style>
.iconButton{
    width: 10vh; 
    padding: 2vw;
    transform: scale(1.0);
}
.iconButton:hover{
    width: 10vh; 
    padding: 2vw;
    transform: scale(1.1);
}
.iconButton:active{
    width: 10vh; 
    padding: 2vw;
    transform: scale(0.9);
}
.iconButtonDisabled{
    width: 10vh; 
    padding: 2vw;
    -webkit-filter: grayscale(100%); /* Safari 6.0 - 9.0 */
    filter: grayscale(100%);
    transform: scale(0.6);
}
.iconButtonPressed{
    width: 10vh; 
    padding: 2vw;
    -webkit-filter: grayscale(100%); /* Safari 6.0 - 9.0 */
    filter: grayscale(100%);
    transform: scale(0.8);
}
</style>
<div style=" position: absolute; top: 50vh; width: 50vw; left: 25vw">
    <img src="record.png" id="record_button" onclick="record()" class="iconButtonDisabled">
    <img src="stop.png" id="stop_button" onclick="stop()" class="iconButtonDisabled">
    <img src="twin.png" id="twin_button" onclick="twin()" class="iconButtonDisabled">
    <img src="clear.png" id="clear_button" onclick="clearButton()" class="iconButtonDisabled">
    <img src="ball.png" id="ball_button" onclick="ballButton()" class="iconButtonDisabled">
</div>


<div style="position: absolute; bottom:0vh; font-size: 5">
<div>Icons made by <a href="https://www.flaticon.com/authors/pixel-perfect" title="Pixel perfect">Pixel perfect</a> from <a href="https://www.flaticon.com/"                title="Flaticon">www.flaticon.com</a> is licensed by <a href="http://creativecommons.org/licenses/by/3.0/"              title="Creative Commons BY 3.0" target="_blank">CC 3.0 BY</a></div>

<div>Icons made by <a href="https://www.flaticon.com/authors/pixel-perfect" title="Pixel perfect">Pixel perfect</a> from <a href="https://www.flaticon.com/"                title="Flaticon">www.flaticon.com</a> is licensed by <a href="http://creativecommons.org/licenses/by/3.0/"              title="Creative Commons BY 3.0" target="_blank">CC 3.0 BY</a></div>
<div>Icons made by <a href="https://www.freepik.com/?__hstc=57440181.0528d1d30fb2118bc439ceeeeb3ab1af.1559238426953.1559238426953.1559246858371.2&__hssc=57440181.16.1559246858371&__hsfp=906796090" title="Freepik">Freepik</a> from <a href="https://www.flaticon.com/"               title="Flaticon">www.flaticon.com</a> is licensed by <a href="http://creativecommons.org/licenses/by/3.0/"              title="Creative Commons BY 3.0" target="_blank">CC 3.0 BY</a></div>
<div>Icons made by <a href="https://www.freepik.com/" title="Freepik">Freepik</a> from <a href="https://www.flaticon.com/"              title="Flaticon">www.flaticon.com</a> is licensed by <a href="http://creativecommons.org/licenses/by/3.0/"              title="Creative Commons BY 3.0" target="_blank">CC 3.0 BY</a></div>
<div>Icons made by <a href="https://www.flaticon.com/authors/mavadee" title="mavadee">mavadee</a> from <a href="https://www.flaticon.com/"              title="Flaticon">www.flaticon.com</a> is licensed by <a href="http://creativecommons.org/licenses/by/3.0/"              title="Creative Commons BY 3.0" target="_blank">CC 3.0 BY</a></div>
</div>

<!-- <script type="text/javascript" src="//code.jquery.com/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> -->
<script type="text/javascript" src="jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="jquery-migrate-1.2.1.min.js"></script>
<script src='/socket.io/socket.io.js'></script>
<script>

    //define zone state:
    var zoneState = new Object();
    zoneState.moduleList = [];
    zoneState.actionList = [];

    //define modules:
    module = new Object();
    module.name = "Ballpit";
    module.active = false;
    zoneState.moduleList.push(module);

    //define modules:
    module = new Object();
    module.name = "Cloner";
    module.active = true;
    zoneState.moduleList.push(module);





    recording = 0;
    connected = 0;
    numSlides = 0;
    var finished_recording = 0;
    var socket = null;

    $(document).ready(function(){
      $('.gif_holder_class').slick({
        slidesToShow: 3,
        arrows: true,
        dots: true,
        infinite: true,
        centerMode: true,
        variableWidth: true,
        adaptiveHeight: true,
        focusOnSelect: true
      });
    });

    $('.gif_holder_class').on('reInit', function(event, slick) {
      //console.log('re init with: ' + numSlides);
      setTimeout(function(){document.getElementById('gif_holder').slick.slickGoTo(numSlides - 1)}, 500);
      //var newSlide = slick.$slides.not($lastSlides);
      //var target = slick.$slides.index(newSlide);
      
      //$slider.slick('slickGoTo', target);

    })

    function record(){
        if(connected == 0){
            return;
        }
        console.log('record');
        if(recording==0){
            recording = 1;



            var action = new Object();
            action.object = "GifRecorder";
            action.command = "startRecording";
            zoneState.actionList.push(action);

            socket.emit('zoneInteractionMessage_realityZoneControlInterface_server',JSON.stringify(zoneState));

            index = indexOfAction(zoneState.actionList, action);
            zoneState.actionList.splice(index,1);


            //socket.emit('startRecording_realityZoneControlInterface_server');
            document.getElementById('record_button').classList.remove("iconButton");
            document.getElementById('record_button').classList.add("iconButtonDisabled");            
        }else{
            //document.getElementById('record_button').classList.remove("iconButtonDisabled");
            //document.getElementById('record_button').classList.add("iconButton");            
        }
    }

    function stop(){
        if(connected == 0){
            return;
        }
        console.log('stop');
        recording = 0;

        var action = new Object();
        action.object = "GifRecorder";
        action.command = "stopRecording";
        zoneState.actionList.push(action);

        socket.emit('zoneInteractionMessage_realityZoneControlInterface_server',JSON.stringify(zoneState));

        index = indexOfAction(zoneState.actionList, action);
        zoneState.actionList.splice(index,1);


        //socket.emit('stopRecording_realityZoneControlInterface_server');
        finished_recording = 1;

        document.getElementById('stop_button').classList.remove("iconButton");
        document.getElementById('stop_button').classList.add("iconButtonDisabled");
        document.getElementById('twin_button').classList.remove("iconButton");
        document.getElementById('twin_button').classList.add("iconButtonDisabled");  
        document.getElementById('clear_button').classList.remove("iconButton");
        document.getElementById('clear_button').classList.add("iconButtonDisabled");     
        document.getElementById('ball_button').classList.remove("iconButton");
        document.getElementById('ball_button').classList.add("iconButtonDisabled");  

        //document.getElementById('record_button').classList.remove("iconButtonDisabled");
        //document.getElementById('record_button').classList.add("iconButton");    
    }

    function indexOfAction(array, action){
        index = -1;
        for(var i = 0; i<array.length; i++){
            if(array[i].object === action.object && array[i].command === action.comand){
                index = i;
            }
        }
        return index;
    }

    function twin(){
        if(connected == 0){
            return;
        }
        var action = new Object();
        action.object = "Cloner";
        action.command = "clone";
        zoneState.actionList.push(action);

        socket.emit('zoneInteractionMessage_realityZoneControlInterface_server',JSON.stringify(zoneState));

        index = indexOfAction(zoneState.actionList, action);
        zoneState.actionList.splice(index,1);



        //socket.emit('twin_realityZoneControlInterface_server');

    }
     
    function clearButton(){
        //console.log('clear button pressed');
        if(connected == 0){
            return;
        }

        var action = new Object();
        action.object = "Cloner";
        action.command = "clear";
        zoneState.actionList.push(action);

        socket.emit('zoneInteractionMessage_realityZoneControlInterface_server',JSON.stringify(zoneState));

        index = indexOfAction(zoneState.actionList, action);
        zoneState.actionList.splice(index,1);

        //socket.emit('clearTwins_realityZoneControlInterface_server');
    }

    function ballButton(){
        //console.log('clear button pressed');
        if(connected == 0){
            return;
        }

        if(document.getElementById('ball_button').classList.contains("iconButtonPressed")){
            document.getElementById('ball_button').classList.remove("iconButtonPressed");
            document.getElementById('ball_button').classList.add("iconButton");

            for(var i = 0; i < zoneState.moduleList.length; i++){
                if(zoneState.moduleList[i].name === "Ballpit"){
                    zoneState.moduleList[i].active = false;
                }
            }


        }else{
            document.getElementById('ball_button').classList.remove("iconButton");
            document.getElementById('ball_button').classList.add("iconButtonPressed");

            for(var i = 0; i < zoneState.moduleList.length; i++){
                if(zoneState.moduleList[i].name === "Ballpit"){
                    zoneState.moduleList[i].active = true;
                }
            }

        }

        socket.emit('zoneInteractionMessage_realityZoneControlInterface_server',JSON.stringify(zoneState));

        /*
        var action = new Object();
        action.object = "Ballpit";
        action.command = "clear";
        zoneState.actionList.push(action);

        socket.emit('zoneInteractionMessage_realityZoneControlInterface_server',JSON.stringify(zoneState));

        index = indexOfAction(zoneState.actionList, action);
        zoneState.actionList.splice(index,1);
        */

        //socket.emit('clearTwins_realityZoneControlInterface_server');
    }



    socket = io();

    socket.on('connect', function(){
        console.log('connect');
        connected = 1;

        document.getElementById('record_button').classList.remove("iconButtonDisabled");
        document.getElementById('record_button').classList.add("iconButton");    
        document.getElementById('stop_button').classList.remove("iconButtonDisabled");
        document.getElementById('stop_button').classList.add("iconButton");    
        document.getElementById('twin_button').classList.remove("iconButtonDisabled");
        document.getElementById('twin_button').classList.add("iconButton");    
        document.getElementById('clear_button').classList.remove("iconButtonDisabled");
        document.getElementById('clear_button').classList.add("iconButton");    
        document.getElementById('ball_button').classList.remove("iconButtonDisabled");
        document.getElementById('ball_button').classList.add("iconButton");   

    });

    socket.on('disconnect', function(){
      console.log('disconnect');
      connected = 0;

      document.getElementById('record_button').classList.remove("iconButton");
      document.getElementById('record_button').classList.add("iconButtonDisabled");    
      document.getElementById('stop_button').classList.remove("iconButton");
      document.getElementById('stop_button').classList.add("iconButtonDisabled");   
      document.getElementById('twin_button').classList.remove("iconButton");
      document.getElementById('twin_button').classList.add("iconButtonDisabled");    
      document.getElementById('clear_button').classList.remove("iconButton");
      document.getElementById('clear_button').classList.add("iconButtonDisabled");    
      document.getElementById('ball_button').classList.remove("iconButton");
      document.getElementById('ball_button').classList.add("iconButtonDisabled");   

      // else the socket will automatically try to reconnect
    });

    socket.on('message', function(data){
    	console.log('received data: ' + data);

    	socket.emit('name','realityZoneControlInterface');


    });

    socket.on('realityZoneGif_server_realityZoneControlInterface', function(data){
    	var gif_url = JSON.parse(data).gifurl;
    	console.log('got url: ' + gif_url);


        //add it to the document:
        var img = document.createElement("img");
        img.src = gif_url;
        img.style.height = '30vh';
        img.style.border = "thick solid #FFFFFF";


        var src = document.getElementById("gif_holder");
        //src.appendChild(img);

        var div = document.createElement('div');
        div.style.border = '20px';
        div.appendChild(img);
        $('.gif_holder_class').slick('slickAdd',div.innerHTML);


        numSlides = numSlides + 1;
        //console.log('slick go to: ' + numSlides);
        //document.getElementById('gif_holder').slick.slickGoTo(numSlides - 1)
        //$('.gif_holder_class').slick('slickGoTo', numSlides - 1);
        //$('.gif_holder_class').slick('slickGoTo', 2);

        //src.appendChild(div);
        if(finished_recording){
            finished_recording = 0;
            document.getElementById('record_button').classList.remove("iconButtonDisabled");
            document.getElementById('record_button').classList.add("iconButton");    
            document.getElementById('stop_button').classList.remove("iconButtonDisabled");
            document.getElementById('stop_button').classList.add("iconButton"); 
            document.getElementById('twin_button').classList.remove("iconButtonDisabled");
            document.getElementById('twin_button').classList.add("iconButton");    
            document.getElementById('clear_button').classList.remove("iconButtonDisabled");
            document.getElementById('clear_button').classList.add("iconButton");    
            document.getElementById('ball_button').classList.remove("iconButtonDisabled");
            document.getElementById('ball_button').classList.add("iconButton");  
        }

    });
</script>



<script type="text/javascript" src="slick/slick.min.js"></script>
</body>

</html>